<body>
	<script type="text/javascript" src="../lib/jQuery-1.9.1.js"></script>
	<script type="text/javascript" src="../lib/underscore-1.4.4.js"></script>
	<script type="text/javascript" src="../lib/Backbone-0.9.10.js"></script>
	<script type="text/javascript" src="../lib/WebMIDIAPI.js"></script>

	<script type="text/javascript" src="audio.io.js"></script>
	<script type="text/javascript" src="audio.io.utils.js"></script>
	<script type="text/javascript" src="audio.io.Pool.js"></script>

	<script type="text/javascript" src="audio.io.Node.js"></script>
	<script type="text/javascript" src="audio.io.Audio.js"></script>
	<script type="text/javascript" src="audio.io.Input.js"></script>

	<script type="text/javascript" src="audio.io.Analyser.js"></script>
	<script type="text/javascript" src="audio.io.Effects.js"></script>
	<script type="text/javascript" src="audio.io.Envelope.js"></script>
	<script type="text/javascript" src="audio.io.Keyboard.js"></script>
	<script type="text/javascript" src="audio.io.LFO.js"></script>
	<script type="text/javascript" src="audio.io.MIDI.js"></script>
	<script type="text/javascript" src="audio.io.Oscillator.js"></script>
	<script type="text/javascript" src="audio.io.StereoPanPot.js"></script>
	<script type="text/javascript" src="audio.io.VolumeControl.js"></script>


	<script type="text/javascript">
		audio.io.initialize();


		var volume = new audio.io.VolumeControl({
			value: 40
		});


		var panPot = new audio.io.StereoPanPot({
			value: 0
		});


		var osc = new audio.io.Oscillator({
			type: 1,
			polyphony: 16,
			numVoices: 1,
			detune: 0
		});

		// osc.connectMod(lfo, 'detune');
		// lfo.connectMod(lfo, 'depth');

		var keyboard = new audio.io.Keyboard();
		keyboard.on('noteOn', function(channel, frequency, velocity) {
			if(velocity !== 0) {
				osc.start(frequency, velocity);
			}
			else {
				osc.stop(frequency, velocity);
			}
		});


		var midi = new audio.io.MIDI({
			channel: 1
		});
		midi.on('noteOn', function(channel, frequency, velocity) {
			if(velocity !== 0) {
				osc.start(frequency, velocity);
			}
			else {
				osc.stop(frequency, velocity);
			}
		});

		var flanger = new audio.io.Flanger({
			delay: 0.01,
			poles: 2,
			frequency: 1000,
			feedback: 0.9,
			lfoRate: 0.1,
			lfoDepth: 0.001,
			dryWet: 50
		});


		osc.connectTo(flanger)
			.connectTo(panPot)
			.connectTo(volume)
			.connectTo(audio.io.masterOut);

	</script>
</body>